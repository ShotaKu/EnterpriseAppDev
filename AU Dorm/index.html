<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-app.js"></script>
    <script type="text/javascript" src="login.js"></script>
    <link rel="icon" href="images/icon.JPG">
    <script src="jquery-3.3.1.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Ravi+Prakash" rel="stylesheet">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>AU Dorm</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <link href="templatemo_style.css" rel="stylesheet" type="text/css" />
    <link href="slideShow.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="gallery_style.css" />
    <script src="commonLayout.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-app.js"></script> -->

</head>
<body>
    <!--ここからヘッダー-->
<div id="templatemo_container">
        <script>showHeader();</script> 
<div id="templatemo_gallery_panel">
<div id="gallery">
  <!-- Slideshow container -->
<div class="slideshow-container">

    <!-- Full-width images with number and caption text -->
    <div class="mySlides fade">
      <div class="numbertext">1 / 3</div>
      <img id="showcase1" src="images/showcaseLoading.gif" style="width:100%" height="250px">
      <div id="showcaseName1" class="text">Caption Text</div>
    </div>
  
    <div class="mySlides fade">
      <div class="numbertext">2 / 3</div>
      <img id="showcase2" src="images/showcaseLoading.gif" style="width:100%"height="250px">
      <div id="showcaseName2" class="text">Caption Two</div>
    </div>
  
    <div class="mySlides fade">
      <div class="numbertext">3 / 3</div>
      <img  id="showcase3" src="images/showcaseLoading.gif" style="width:100%"height="250px">
      <div id="showcaseName3" class="text">Caption Three</div>
    </div>    
    <!-- Next and previous buttons -->
    <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
    <a class="next" onclick="plusSlides(1)">&#10095;</a>
  </div>
  <br>
  
  <!-- The dots/circles -->
  <div style="text-align:center">
    <span class="dot" onclick="currentSlide(1)"></span> 
    <span class="dot" onclick="currentSlide(2)"></span> 
    <span class="dot" onclick="currentSlide(3)"></span> 
  </div>
</div>
<script type="text/javascript" src="slide.js"></script>
<!-- <script type="text/javascript" src="slide.js"></script> -->

</div>
<!-- ここからAbout と 検索-->
<div id="templatemo_content_panel_1">

	<div id="templatemo_news_section">
    	<h1>About this site</h1>
        <div class="templatemo_news_box">
        	<h3>Dormitory Catalog for AU students</h3>
            <p>This website is created for Assumption University student to choose their best dormitory. You can search dormitory and check available room of each dormitory at this website.  </p>
      </div>
      
    </div><!-- end of news section -->
    <div id="templatemo_section_1_1">
    	<h1>Find a room</h1>
        <form method="get" action="#">
        	<div class="left_column">
                <!-- <div class="form_row"> <label>Dormitory name: </label><input type="text" name="country" value="" /> </div> -->
                <div class="form_row"> <label>Dormitory name: </label>
                	<select name="dormitory">
                        <option>Unspecified</option>
                        <option>Assumption University</option>
                        </select>
                </div>
                <div class="form_row">
                        <label>Price: </label>
                        <select name="min-price">
                            <option>minimum</option>
                            <option>฿2000/Mon</option>
                            <option>฿2500/Mon</option>
                            <option>฿3000/Mon</option>
                            <option>฿3500/Mon</option>
                            <option>฿4000/Mon</option>
                        </select>
                        <label>To: </label>
                        <select name="max-price">
                            <option>maximum</option>
                            <option>฿2000/Mon</option>
                            <option>฿2500/Mon</option>
                            <option>฿3000/Mon</option>
                            <option>฿3500/Mon</option>
                            <option>฿4000/Mon</option>
                        </select>
                   </div>
                <!-- <div class="form_row"> <label>Zip / Postal code </label><input type="text" name="country" value="" /> </div> -->
            </div>
            <div class="right_column">
	                
               	<div class="form_row"> <label>The other option 1: </label>
                	<select name="option1">
                            <option>Unspecified</option>
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <div class="form_row"> <label>The other option 2: </label>
                	<select name="option1">
                            <option>Unspecified</option>
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <div class="form_row"> <label>The other option 3: </label>
                	<select name="option1">
                        <option>Unspecified</option>
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option>5</option>
                    </select>
                </div>
                <div class="form_row"> 
                	<input type="submit" value="Submit" name="submit" class="submit_btn_02" />
                </div>
            </div>
            
        </form>
    </div><!-- end of section 1 -->
    <div class="cleaner_with_height">&nbsp;</div>
</div>
<!-- ここから寮ショーケース -->
<div id="templatemo_content_panel_2">
	<div class="templatemo_section_2">
        
        <img id="dormImage1" src="images/loading.gif" alt="image" width="200" height="150"/>
        <h4 id = "dormName1">null</h4>
        <p id = "dormDetail1">null</p>
        <div class="price">PRICE:<span id="dormPrice1"> $1,234,000</span></div>    
        <div id="dormLink1" class="readmore"><a href="index.html">Read more</a></div>                       
    </div>
    <div class="templatemo_section_2">
        <img id="dormImage2" src="images/loading.gif" alt="image" width="200" height="150"/>
        <h4 id= "dormName2">null</h4>
        <p id = "dormDetail2">null</p>
        <div class="price">PRICE:<span> $876,000</span></div>                           
        <div  id="dormLink2" class="readmore"><a href="index.html">Read more</a></div>
    </div>
    <div class="templatemo_section_2">

        <img id="dormImage3" src="images/loading.gif" alt="image" width="200" height="150"/>
        <h4 id= "dormName3">null</h4>
        <p id = "dormDetail3">null</p>
        <div class="price">PRICE:<span> $2,468,000</span></div>                           
      <div id="dormLink3"  class="readmore"><a href="index.html">Read more</a></div>
    </div>
    
    <div class="cleaner_with_height">&nbsp;</div>
</div> <!-- end of content panel 2 -->

<div id="templatemo_content_panel_3">

	<div class="templatemo_quick_contact">
    	<h1>Quick Contact</h1>
        <p>
            Tel: 02-723-2222<br />
            Location: Student Leadership & Experiential Learning Center @King David (CSLEL)<br />
            Email:  auso2015@hotmail.com
        </p>
    </div><!-- end of news section 3-->
    
   <div class="templatemo_section_3">
    	<h1>Helpful Links</h1>
        	<ul class="list_section">
                <li><a href="#">FAQs</a></li>
                <li><a href="#">Terms of use</a></li>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Contact Us</a></li>
            </ul>
    </div>
    <div class="templatemo_section_3">
    	<h1>Partner Links</h1>
        	<ul class="list_section">
                <li><a href="http://www.au.edu" target="_blank">Assumption University</a></li>
                <li><a href="http://auso.au.edu/" target="_blank">AUSO</a></li>
                <li><a href="http://www.scitech.au.edu/" target="_blank">Science and Technology</a></li>
            </ul>
    </div>
    
<div class="cleaner_with_height">&nbsp;</div>
</div><!-- end of content panel 3 -->

<div id="templatemo_footer_panel">
    Copyright © 2048 <a href="index.html">Your Company Name</a> | <a href="http://www.iwebsitetemplate.com" target="_parent">Website Templates</a> by <a href="http://www.templatemo.com" target="_blank">Free CSS Templates</a></div>
</div> <!-- 一番最後 -->
<!-- <div align=center>This template  downloaded form <a href='http://all-free-download.com/free-website-templates/'>free website templates</a></div>-->
</body> 
<script src="https://www.gstatic.com/firebasejs/5.3.1/firebase.js"></script>

<script>
    
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBO3AHVZG4mF5WvJvVfX-RcWrNceWku5u4",
    authDomain: "audorm-c6dae.firebaseapp.com",
    databaseURL: "https://audorm-c6dae.firebaseio.com",
    projectId: "audorm-c6dae",
    storageBucket: "audorm-c6dae.appspot.com",
    //messagingSenderId: "715848706924"
  };
  firebase.initializeApp(config);
var database = firebase.database();
// alert(firebase.app().name);
var dataRef = database.ref('Dormitory');
var showCaseRef = database.ref('Showcase');
checkLoginStatus();
isUserExist(database,"hoge").then(function(v){
    console.log("Is hoge exist?: "+ v);
});

showCaseRef.once("value").then(function(snapshot)
{
    var im = 1;
    console.log("Start load images:"+ snapshot.key);
    snapshot.forEach(function(childSnapshot) {
        if(im<=3)
        {
            var imageURL = childSnapshot.child("image").val();
            var name = childSnapshot.child("name").val();
            console.log((im-1)+":"+imageURL);
            if(imageURL != null){
               document.getElementById("showcase"+im).src = imageURL;
            }
            if(name != null){
                document.getElementById("showcaseName"+im).innerHTML = name;
            }
            else{
                console.error("No name for caption id:"+im);
            }
        }
        im++;
    });
})
dataRef.once("value")
    .then(function(snapshot){
        var i = 0;
        var dormID = 0;
        snapshot.forEach(function(childSnapshot) {
            dormID = childSnapshot.key;
            if(i<3)
            {
                //console.log("Dorm "+dormID);
                var dormName = childSnapshot.child("name").val();
                var imgURL = childSnapshot.child("thumbnail").val();
                var detail = childSnapshot.child("detail").val();
                document.getElementById("dormName"+(i+1)).innerHTML = dormName;
                document.getElementById("dormImage"+(i+1)).src = imgURL;
                document.getElementById("dormDetail"+(i+1)).innerHTML = detail;
                
                var rooms = childSnapshot.child("rooms");
                var avgPrise = 0;
                var roomNum = 0;
                rooms.forEach(function(childSnapshot)
                {
                    //console.log("room: "+childSnapshot.key);
                    var prise = childSnapshot.child("prise").val();
                    avgPrise += prise;
                    roomNum++;
                });
                if(0 < roomNum)
                {
                    avgPrise/=roomNum;
                    document.getElementById("dormPrice"+(i+1)).innerHTML = " "+avgPrise+"Baht";
                }
                else
                {
                    console.log(dormName + " do not have any room.(Average prise error)")
                }
            i++;
            }
        });
    })
</script>
</html>